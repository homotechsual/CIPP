<!doctype html>
<html class="docs-version-current" lang="en-GB" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/releases/rss.xml" title="CyberDrain Improved Partner Portal RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/releases/atom.xml" title="CyberDrain Improved Partner Portal Atom Feed">
<link rel="alternate" type="application/json" href="/releases/feed.json" title="CyberDrain Improved Partner Portal JSON Feed">
<link key="docusaurus-plugin-plausible-preconnect" rel="preconnect" href="https://plausible.io">
<script key="docusaurus-plugin-plausible-script" async defer="defer" data-domain="cipp.app" src="https://plausible.io/js/plausible.js"></script>
<script key="docusaurus-plugin-plausible-custom-events">window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><title data-rh="true">Prerequisites | CyberDrain Improved Partner Portal</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cipp.app/docs/user/gettingstarted/prerequisites/"><meta data-rh="true" name="docsearch:language" content="en-GB"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="language" content="en-GB"><meta data-rh="true" name="version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="keywords" content="CIPP, CyberDrain Improved Partner Portal, Microsoft 365, Management, Multi-Tenant, MSP, Azure, Microsoft Partner, Lighthouse"><meta data-rh="true" property="og:title" content="Prerequisites | CyberDrain Improved Partner Portal"><meta data-rh="true" name="description" content="How to prepare to install an instance of CIPP for your organisation."><meta data-rh="true" property="og:description" content="How to prepare to install an instance of CIPP for your organisation."><link data-rh="true" rel="icon" href="/img/CyberDrainIconOrangeWhite.png"><link data-rh="true" rel="canonical" href="https://cipp.app/docs/user/gettingstarted/prerequisites/"><link data-rh="true" rel="alternate" href="https://cipp.app/docs/user/gettingstarted/prerequisites/" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://cipp.app/docs/user/gettingstarted/prerequisites/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.81b2c8da.css">
<link rel="preload" href="/assets/js/runtime~main.33dd48f4.js" as="script">
<link rel="preload" href="/assets/js/main.87e4ca81.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/CyberDrainIconOrangeWhite.png" alt="CIPP Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/CyberDrainIconOrangeWhite.png" alt="CIPP Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">CyberDrain Improved Partner Portal</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Documentation</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/docs/user/">User</a></li><li><a class="dropdown__link" href="/docs/dev/">Developer</a></li><li><a class="dropdown__link" href="/docs/api/">API</a></li><li><a class="dropdown__link" href="/docs/general/knownbugs/">Known Bugs</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Project</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/releases/">Releases</a></li><li><a class="dropdown__link" href="/contributors/">Contributors</a></li><li><a class="dropdown__link" href="/contributing/">How to Contribute</a></li><li><a class="dropdown__link" href="/docs/general/faq/">FAQ</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/general/troubleshooting/">Troubleshooting</a><a class="navbar__item navbar__link" href="/docs/general/demo/">Demo</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Security</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/security/">Security Policy</a></li><li><a class="dropdown__link" href="/vdp/">Vulnerability Disclosure</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/cyberdrain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link discord-link" aria-label="Discord"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link github-link">GitHub</a><ul class="dropdown__menu"><li><a href="https://github.com/KelvinTegelaar/CIPP" target="_blank" rel="noopener noreferrer" class="dropdown__link" aria-label="GitHub">CIPP</a></li><li><a href="https://github.com/KelvinTegelaar/CIPP-API" target="_blank" rel="noopener noreferrer" class="dropdown__link" aria-label="GitHub">CIPP-API</a></li></ul></div><div class="toggle_MW0i toggle_TdHA toggleDisabled_YIE3"><div class="toggleButton_yw5v" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="toggleIcon_oIOL lightToggleIcon_SFTY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="toggleIcon_oIOL darkToggleIcon_ekgs"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_Ya9V" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-dev-current,docs-general-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_dnJg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_CEHd"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/user/gettingstarted/">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user/gettingstarted/prerequisites/">Prerequisites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user/gettingstarted/permissions/">Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user/gettingstarted/installation/">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user/gettingstarted/postinstall/">Post-Install Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user/gettingstarted/roles/">Roles</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/user/usingcipp/">Using CIPP</a><button aria-label="Toggle the collapsible sidebar category &#x27;Using CIPP&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/dashboard/">Dashboard</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/identitymanagement/">Identity Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Identity Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/tenantadministration/">Tenant Administration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tenant Administration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/securitycompliance/">Security &amp; Compliance</a><button aria-label="Toggle the collapsible sidebar category &#x27;Security &amp; Compliance&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/endpointmanagement/">Endpoint Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Endpoint Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/teamsonedrivesharepoint/">Teams, OneDrive &amp; Sharepoint</a><button aria-label="Toggle the collapsible sidebar category &#x27;Teams, OneDrive &amp; Sharepoint&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/emailexchange/">Email &amp; Exchange</a><button aria-label="Toggle the collapsible sidebar category &#x27;Email &amp; Exchange&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/user/usingcipp/settings/">Settings</a><button aria-label="Toggle the collapsible sidebar category &#x27;Settings&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user/updating/">Updating</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_XeRd"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/user/gettingstarted/">Getting Started</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/user/gettingstarted/prerequisites/">Prerequisites</a></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Prerequisites</h1></header><p>To get started make sure you have the following information ready;</p><ul><li>Your Secure Application Model information</li><li>A <a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo" target="_blank" rel="noopener noreferrer">fork</a> of <a href="https://github.com/KelvinTegelaar/CIPP" target="_blank" rel="noopener noreferrer">the CIPP GitHub</a> repository.</li><li>A <a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo" target="_blank" rel="noopener noreferrer">fork</a> of <a href="https://github.com/KelvinTegelaar/CIPP-API" target="_blank" rel="noopener noreferrer">the CIPP API GitHub</a> repository.</li><li>An active Azure Subscription.</li><li>A GitHub Personal Access Token. You can find instructions on what you need and the minimum permissions to do this <a href="https://docs.microsoft.com/en-us/azure/static-web-apps/publish-azure-resource-manager?tabs=azure-cli#create-a-github-personal-access-token" target="_blank" rel="noopener noreferrer">in Microsoft&#x27;s Azure Static Web Apps documentation</a>. You only need the &quot;Create a GitHub Personal Access Token&quot; section.</li></ul><p>For the installation and maintenance, it&#x27;s assumed you have some knowledge of GitHub.</p><p>If you haven&#x27;t setup the Secure Application Model (SAM) use the instructions below and then move onto the next page to configure the permissions for your SAM application.</p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Secure Application Model account</h5></div><div class="admonition-content"><p>It is <strong>strongly</strong> recommended that you use a separate global administrator account for each Secure Application Model application you create. This avoids conflicts that occur when using existing accounts which may be in customer tenants as guest users and provides better tracing in audit logs.</p><p><strong>This service account should be a Global Admin (in your tenant) and given Admin Agent (in partner center)</strong>.</p></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Setting up the Secure Application Model</h5></div><div class="admonition-content"><ul><li>Haven&#x27;t setup the Secure Application model yet? Check out <a href="https://www.cyberdrain.com/connect-to-exchange-online-automated-when-mfa-is-enabled-using-the-secureapp-model/" target="_blank" rel="noopener noreferrer">this CyberDrain blog post</a>.</li><li>For a step-by-step guide to setting up the Secure Application Model, see <a href="https://www.gavsto.com/secure-application-model-for-the-layman-and-step-by-step/" target="_blank" rel="noopener noreferrer">this Gavsto blog post</a>.</li></ul></div></div><p>If you just need the script to setup the Secure Application Model (SAM) it&#x27;s below.</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Secure App Model Setup Script</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div style="color:#000000;background-color:#ffffff" class="codeBlockTitle_BvAR">New-SAMAzureADApplication.ps1</div><div class="codeBlockContent_wNvx powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">Param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Parameter(Mandatory = $false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[switch]</span><span class="token variable" style="color:rgb(9, 134, 88)">$ConfigurePreconsent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Parameter(Mandatory = $true)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[string]</span><span class="token variable" style="color:rgb(9, 134, 88)">$DisplayName</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Parameter(Mandatory = $false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[string]</span><span class="token variable" style="color:rgb(9, 134, 88)">$TenantId</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$ErrorActionPreference</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Stop&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Check if the Azure AD PowerShell module has already been loaded.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-Module</span><span class="token plain"> AzureAD </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># Check if the Azure AD PowerShell module is installed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ListAvailable </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Name AzureAD </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># The Azure AD PowerShell module is not load and it is installed. This module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># must be loaded for other operations performed by this script.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Loading the Azure AD PowerShell module...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Import-Module</span><span class="token plain"> AzureAD</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Install-Module</span><span class="token plain"> AzureAD</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;When prompted please enter the appropriate credentials... Warning: Window might have pop-under in VSCode&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">[string]</span><span class="token plain">::IsNullOrEmpty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$TenantId</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Connect-AzureAD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Out-Null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token variable" style="color:rgb(9, 134, 88)">$TenantId</span><span class="token plain"> = $</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">Get-AzureADTenantDetail</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ObjectId</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Connect-AzureAD</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">TenantId </span><span class="token variable" style="color:rgb(9, 134, 88)">$TenantId</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Out-Null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">catch</span><span class="token plain"> </span><span class="token namespace">[Microsoft.Azure.Common.Authentication.AadAuthenticationCanceledException]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># The authentication attempt was canceled by the end-user. Execution of the script should be halted.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Yellow </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;The authentication attempt was canceled. Execution of the script will be halted...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># An unexpected error has occurred. The end-user should be notified so that the appropriate action can be taken.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Error</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;An unexpected error has occurred. Please review the following error message and try again.&quot;</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$Error</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string function" style="color:rgb(0, 0, 255)">0</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">Exception</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$adAppAccess</span><span class="token plain"> = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAppId = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;00000002-0000-0000-c000-000000000000&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAccess = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;5778995a-e1bf-45b8-affa-663a9f3f4d04&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Role&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a42657d6-7f20-40e3-b6f0-cee03008a62a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Scope&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;311a71cc-e848-46a1-bdf8-97ff7156d8e6&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Scope&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$graphAppAccess</span><span class="token plain"> = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAppId = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;00000003-0000-0000-c000-000000000000&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAccess = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;bf394140-e372-4bf9-a898-299cfc7564e5&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Role&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;7ab1d382-f21e-4acd-a863-ba3e13f7da61&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Role&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$partnerCenterAppAccess</span><span class="token plain"> = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAppId = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;fa3d9a0c-3fb0-42cc-9193-47c7ecd2edbd&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ResourceAccess = </span><span class="token namespace">[Microsoft.Open.AzureAD.Model.ResourceAccess]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Id = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;1cebfa2a-fb4d-419e-b5f9-839b4383e05a&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Type</span><span class="token plain"> = </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Scope&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$SessionInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">Get-AzureADCurrentSessionInfo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Creating the Azure AD application and related resources...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$app</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-AzureADApplication</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">AvailableToOtherTenants </span><span class="token boolean">$true</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">DisplayName </span><span class="token variable" style="color:rgb(9, 134, 88)">$DisplayName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">IdentifierUris </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$SessionInfo</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">TenantDomain</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">/</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function" style="color:rgb(0, 0, 255)">New-Guid</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">.ToString())&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">RequiredResourceAccess </span><span class="token variable" style="color:rgb(9, 134, 88)">$adAppAccess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$graphAppAccess</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$partnerCenterAppAccess</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ReplyUrls @</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;urn:ietf:wg:oauth:2.0:oob&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://login.microsoftonline.com/organizations/oauth2/nativeclient&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;https://localhost&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;http://localhost&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;http://localhost:8400&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$password</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-AzureADApplicationPasswordCredential</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ObjectId </span><span class="token variable" style="color:rgb(9, 134, 88)">$app</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ObjectId</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-AzureADServicePrincipal</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">AppId </span><span class="token variable" style="color:rgb(9, 134, 88)">$app</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AppId </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">DisplayName </span><span class="token variable" style="color:rgb(9, 134, 88)">$DisplayName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$adminAgentsGroup</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">Get-AzureADGroup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">Filter</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;DisplayName eq &#x27;AdminAgents&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Add-AzureADGroupMember</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ObjectId </span><span class="token variable" style="color:rgb(9, 134, 88)">$adminAgentsGroup</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ObjectId </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">RefObjectId </span><span class="token variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ObjectId</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Installing PartnerCenter Module.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">install-module</span><span class="token plain"> PartnerCenter </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Sleeping for 30 seconds to allow app creation on O365&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">foregroundcolor green</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">start-sleep</span><span class="token plain"> 30</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Please approve General consent form.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$PasswordToSecureString</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(9, 134, 88)">$password</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">ConvertTo-SecureString</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">asPlainText </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Force</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$credential</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-Object</span><span class="token plain"> System</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Management</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Automation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">PSCredential</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">$</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$app</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AppId</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token variable" style="color:rgb(9, 134, 88)">$PasswordToSecureString</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$token</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-PartnerAccessToken</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ApplicationId </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$app</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">AppId</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Scopes </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;https://api.partnercenter.microsoft.com/user_impersonation&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ServicePrincipal </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Credential </span><span class="token variable" style="color:rgb(9, 134, 88)">$credential</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Tenant $</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AppOwnerTenantID</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">UseAuthorizationCode</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Please approve Exchange consent form.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$Exchangetoken</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">New-PartnerAccessToken</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ApplicationId </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;a0c73c16-a7e3-4564-9a95-2bdf47383716&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Scopes </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;https://outlook.office365.com/.default&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Tenant $</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">AppOwnerTenantID</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">UseDeviceAuthentication</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Last initiation required: Please browse to https://login.microsoftonline.com/</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">AppOwnerTenantID</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">/adminConsent?client_id=</span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$app</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">AppId</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Press any key after auth. An error report about incorrect URIs is expected!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token namespace">[void]</span><span class="token namespace">[System.Console]</span><span class="token plain">::ReadKey</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">$true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;================ Secrets ================&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;`</span><span class="token string variable" style="color:rgb(9, 134, 88)">$ApplicationId</span><span class="token string" style="color:rgb(163, 21, 21)">         = </span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$app</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">AppId</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;`</span><span class="token string variable" style="color:rgb(9, 134, 88)">$ApplicationSecret</span><span class="token string" style="color:rgb(163, 21, 21)">     = </span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$password</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">Value</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;`</span><span class="token string variable" style="color:rgb(9, 134, 88)">$TenantID</span><span class="token string" style="color:rgb(163, 21, 21)">              = </span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$spn</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">AppOwnerTenantID</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;`</span><span class="token string variable" style="color:rgb(9, 134, 88)">$RefreshToken</span><span class="token string" style="color:rgb(163, 21, 21)">          = </span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$token</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">refreshtoken</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Blue</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">write-host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;`</span><span class="token string variable" style="color:rgb(9, 134, 88)">$Exchange</span><span class="token string" style="color:rgb(163, 21, 21)"> RefreshToken = </span><span class="token string function" style="color:rgb(0, 0, 255)">$</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string function variable" style="color:rgb(9, 134, 88)">$ExchangeToken</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token string function" style="color:rgb(0, 0, 255)">Refreshtoken</span><span class="token string function punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">ForegroundColor Green</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;================ Secrets ================&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;    SAVE THESE IN A SECURE LOCATION     &quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p></p></div></div></details><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Consent, Risk and Conditional Access</h5></div><div class="admonition-content"><p>Setting up SAM tokens for the first time, presents three consent steps. Make sure you consent to all three.</p><p>You should make sure that the user account you&#x27;re using to generate your SAM tokens isn&#x27;t listed as a <a href="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-investigate-risk" target="_blank" rel="noopener noreferrer">risky user</a>.</p><p>The account you use for your SAM tokens must <strong>NOT</strong> have an exemption/exclusion from MFA checks resulting from Conditional Access policies.</p></div></div><p>Now that you have SAM setup, move onto configuring permissions using the Next button below.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/KelvinTegelaar/CIPP/tree/website/docs/user/gettingstarted/prerequisites/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-18T14:01:03.000Z">18/03/2022</time></b> by <b>Michael O&#x27;Toole</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/user/gettingstarted/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/user/gettingstarted/permissions/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Permissions</div></a></div></nav></div></div></div></div></main></div></div><div class="pre-footer"><div class="container padding-vert--lg sponsors-carousel"><h2><span class="pre-footer--title">Sponsored By</span></h2><div class="alice-carousel"><div><div style="padding-left:50px;padding-right:50px" class="alice-carousel__wrapper"><ul style="transition:transform 0ms ease 0ms;transform:translate3d(0px, 0, 0)" class="alice-carousel__stage"><li style="width:0" class="alice-carousel__stage-item __cloned"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://immy.bot/" title="ImmyBot" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/ImmyBot.png" alt="ImmyBot" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item __cloned"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://www.huntress.com/" title="Huntress" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/Huntress.png" alt="Huntress" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item __active __target"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://oit.co" title="OIT" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/OIT.webp" alt="OIT" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://www.genuinetechnology.com/" title="Genuine Technology Group" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/GenuineTechnologyGroup.png" alt="Genuine Technology Group" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://www.ninjaone.com/" title="NinjaOne" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/NinjaOne.png" alt="NinjaOne" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://immy.bot/" title="ImmyBot" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/ImmyBot.png" alt="ImmyBot" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://www.huntress.com/" title="Huntress" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/Huntress.png" alt="Huntress" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item __cloned"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://oit.co" title="OIT" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/OIT.webp" alt="OIT" role="presentation" style="max-height:75px"></a></div></li><li style="width:0" class="alice-carousel__stage-item __cloned"><div class="item" style="max-height:75px;max-width:250px;text-align:center"><a href="https://www.genuinetechnology.com/" title="Genuine Technology Group" target="_blank" rel="noreferrer noopener" class="sponsor-item item-inner"><img src="/img/sponsors/GenuineTechnologyGroup.png" alt="Genuine Technology Group" role="presentation" style="max-height:75px"></a></div></li></ul></div></div><ul class="alice-carousel__dots"><li class="alice-carousel__dots-item __active"></li><li class="alice-carousel__dots-item"></li><li class="alice-carousel__dots-item"></li><li class="alice-carousel__dots-item"></li><li class="alice-carousel__dots-item"></li></ul></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/user/">User Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dev/">Developer Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api/">API Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/faq/">Frequently Asked Questions</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/general/knownbugs/">Known Bugs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/contributors/">Contributors</a></li><li class="footer__item"><a href="https://discord.gg/cyberdrain" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://reddit.com/r/msp" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://cyberdrain.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CyberDrain Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://ctf.cyberdrain.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CyberDrain CtF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/KelvinTegelaar/CIPP/issues/new?assignees=&amp;labels=&amp;template=feature_request.md&amp;title=FEATURE+REQUEST%3A+" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Submit Feature Request<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/KelvinTegelaar/CIPP/issues/new?assignees=&amp;labels=&amp;template=bug_report.md&amp;title=BUG%3A+" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Submit Bug Report<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footerLogoLink_fGS1"><img src="/img/Docusaurus.svg" alt="Docusaurus Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo" width="50" height="50"><img src="/img/Docusaurus.svg" alt="Docusaurus Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo" width="50" height="50"></a></div><div class="footer__copyright">Copyright © 2022 CyberDrain. Built with <a href="https://docusaurus.io">Docusaurus</a>.<br> Want to sponsor cipp? Contact Kelvin!</div></div></div></footer></div>
<script src="/assets/js/runtime~main.33dd48f4.js"></script>
<script src="/assets/js/main.87e4ca81.js"></script>
</body>
</html>