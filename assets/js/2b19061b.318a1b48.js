"use strict";(self.webpackChunkcipp_docs=self.webpackChunkcipp_docs||[]).push([[9706],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=d(n),m=r,g=p["".concat(l,".").concat(m)]||p[m]||c[m]||i;return n?a.createElement(g,o(o({ref:t},u),{},{components:n})):a.createElement(g,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},2990:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return h},frontMatter:function(){return d},metadata:function(){return c},toc:function(){return m}});var a,r=n(7462),i=n(3366),o=(n(7294),n(3905)),s=n(5108),l=["components"],d={id:"domainsanalyser",title:"Domains Analyser",description:"Check your managed domains against security and configuration best practices.",slug:"/usingcipp/tenantadministration/domainsanalyser"},u=void 0,c={unversionedId:"usingcipp/tenantadministration/domainsanalyser",id:"usingcipp/tenantadministration/domainsanalyser",title:"Domains Analyser",description:"Check your managed domains against security and configuration best practices.",source:"@site/docs/user/usingcipp/tenantadministration/domainsanalyser.mdx",sourceDirName:"usingcipp/tenantadministration",slug:"/usingcipp/tenantadministration/domainsanalyser",permalink:"/docs/user/usingcipp/tenantadministration/domainsanalyser",editUrl:"https://github.com/KelvinTegelaar/CIPP/tree/website/docs/user/usingcipp/tenantadministration/domainsanalyser.mdx",tags:[],version:"current",lastUpdatedBy:"Michael O'Toole",lastUpdatedAt:1648310395,formattedLastUpdatedAt:"26/03/2022",frontMatter:{id:"domainsanalyser",title:"Domains Analyser",description:"Check your managed domains against security and configuration best practices.",slug:"/usingcipp/tenantadministration/domainsanalyser"},sidebar:"userSidebar",previous:{title:"Best Practice Analyser",permalink:"/docs/user/usingcipp/tenantadministration/bestpracticeanalyser"},next:{title:"Individual Domain Check",permalink:"/docs/user/usingcipp/tenantadministration/individualdomaincheck"}},p={},m=[{value:"Getting Started",id:"getting-started",level:2},{value:"Refreshing / Generating the Data",id:"refreshing--generating-the-data",level:2},{value:"Interpreting Results",id:"interpreting-results",level:2},{value:"Security Score",id:"security-score",level:3},{value:"Sender Policy Framework Pass Test",id:"sender-policy-framework-pass-test",level:3},{value:"Mail Exchanger Pass Test",id:"mail-exchanger-pass-test",level:3},{value:"Domain-based Message Authentication, Reporting &amp; Conformance Present",id:"domain-based-message-authentication-reporting--conformance-present",level:3},{value:"Domain-based Message Authentication, Reporting &amp; Conformance Action Policy",id:"domain-based-message-authentication-reporting--conformance-action-policy",level:3},{value:"Domain-based Message Authentication, Reporting &amp; Conformance % Pass",id:"domain-based-message-authentication-reporting--conformance--pass",level:3},{value:"Domain Name System Security Extensions",id:"domain-name-system-security-extensions",level:3},{value:"DomainKeys Identified Mail Enabled",id:"domainkeys-identified-mail-enabled",level:3},{value:"Common Problems",id:"common-problems",level:2},{value:"Feature Requests / Ideas",id:"feature-requests--ideas",level:2},{value:"Known Issues / Limitations",id:"known-issues--limitations",level:2}],g=(a="NoKnownIssues",function(e){return s.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",e)}),k={toc:m};function h(e){var t=e.components,n=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,r.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The domain analyser is a series of best practice checks that run on all your e-mail enabled domains across your delegated Microsoft 365 tenants."),(0,o.kt)("p",null,"It analyses the DNS records that are available and assesses the following areas:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Sender Policy Framework (SPF)"),(0,o.kt)("li",{parentName:"ul"},"Domain-based Message Authentication, Reporting & Conformance (DMARC)"),(0,o.kt)("li",{parentName:"ul"},"DomainKeys Identified Mail (DKIM)"),(0,o.kt)("li",{parentName:"ul"},"Domain Name System Security Extensions (DNSSEC)")),(0,o.kt)("p",null,"Please note - clicking ",(0,o.kt)("strong",{parentName:"p"},"More")," at the end of each row provides detailed information on identified problems."),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,"If this is your first ever run you may see an error initially because there is no data, please wait for the analyser to run or use the refresh button."),(0,o.kt)("h2",{id:"refreshing--generating-the-data"},"Refreshing / Generating the Data"),(0,o.kt)("p",null,"At the top of the page there is button called ",(0,o.kt)("strong",{parentName:"p"},"Force Refresh All Data"),". You should only use this once."),(0,o.kt)("h2",{id:"interpreting-results"},"Interpreting Results"),(0,o.kt)("p",null,"The reporting here follows a standard colour theme. Red is bad and not something that should be happening on your tenant. Orange is either a warning or subjective. It doesn't necessarily indicate something is wrong. Green means there are no issues or the setting's configured in a manner that's meets the best practice."),(0,o.kt)("h3",{id:"security-score"},"Security Score"),(0,o.kt)("p",null,"A measure of the overall security of the domain calculated by taking the following into account:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"SPF"),(0,o.kt)("li",{parentName:"ul"},"MX"),(0,o.kt)("li",{parentName:"ul"},"DMARC"),(0,o.kt)("li",{parentName:"ul"},"DKIM"),(0,o.kt)("li",{parentName:"ul"},"DNSSEC")),(0,o.kt)("p",null,"There's a detailed breakdown of each check and the score points available for it below:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Item"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:"center"},"Points"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"SPF Present"),(0,o.kt)("td",{parentName:"tr",align:null},"SPF is present"),(0,o.kt)("td",{parentName:"tr",align:"center"},"10")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"SPF MX Recommended"),(0,o.kt)("td",{parentName:"tr",align:null},"SPF is present and set as determined from the MX records."),(0,o.kt)("td",{parentName:"tr",align:"center"},"10")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"SPF Correct All"),(0,o.kt)("td",{parentName:"tr",align:null},"SPF is present and set correctly."),(0,o.kt)("td",{parentName:"tr",align:"center"},"10")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"MX Provider Recommended"),(0,o.kt)("td",{parentName:"tr",align:null},"MX records are present and set as recommended by provider."),(0,o.kt)("td",{parentName:"tr",align:"center"},"10")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DMARC Present"),(0,o.kt)("td",{parentName:"tr",align:null},"DMARC is present."),(0,o.kt)("td",{parentName:"tr",align:"center"},"10")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DMARC Set Quarantine"),(0,o.kt)("td",{parentName:"tr",align:null},"DMARC set to quarantine."),(0,o.kt)("td",{parentName:"tr",align:"center"},"20")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DMARC Set Reject"),(0,o.kt)("td",{parentName:"tr",align:null},"DMARC set to reject."),(0,o.kt)("td",{parentName:"tr",align:"center"},"30")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DMARC Reporting Active"),(0,o.kt)("td",{parentName:"tr",align:null},"DMARC reporting is active."),(0,o.kt)("td",{parentName:"tr",align:"center"},"20")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DMARC Percentage Good"),(0,o.kt)("td",{parentName:"tr",align:null},"DMARC percentage set to a value of 100."),(0,o.kt)("td",{parentName:"tr",align:"center"},"20")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DNSSEC Present"),(0,o.kt)("td",{parentName:"tr",align:null},"DNSSEC is present."),(0,o.kt)("td",{parentName:"tr",align:"center"},"20")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"DKIM Active and Working"),(0,o.kt)("td",{parentName:"tr",align:null},"DKIM is active and working."),(0,o.kt)("td",{parentName:"tr",align:"center"},"20")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"Total Possible Points")),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"td"},"180"))))),(0,o.kt)("h3",{id:"sender-policy-framework-pass-test"},"Sender Policy Framework Pass Test"),(0,o.kt)("p",null,"A check that your domains meet the following conditions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Using the recommended SPF record that your mail provider suggests."),(0,o.kt)("li",{parentName:"ul"},"SPF set to hard fail as opposed to soft fail.")),(0,o.kt)("h3",{id:"mail-exchanger-pass-test"},"Mail Exchanger Pass Test"),(0,o.kt)("p",null,"A check that your MX records are present and set correctly based on what your mail provider recommends. Where this is failing you likely have a domain in your 365 tenant that's using e-mail elsewhere, or has a mis-configured MX record."),(0,o.kt)("h3",{id:"domain-based-message-authentication-reporting--conformance-present"},"Domain-based Message Authentication, Reporting & Conformance Present"),(0,o.kt)("p",null,"A check that you have a DMARC record. Your domains absolutely should have a correctly configured DMARC or you are putting this domain at risk of spoofing."),(0,o.kt)("h3",{id:"domain-based-message-authentication-reporting--conformance-action-policy"},"Domain-based Message Authentication, Reporting & Conformance Action Policy"),(0,o.kt)("p",null,"Your DMARC record is only as good as the action set on it."),(0,o.kt)("p",null,"If you're just starting out with DMARC, start by creating a record in reporting only mode, and utilising a DMARC aggregation / reporting service to assess reports. The ideal setting for your DMARC policy is reject."),(0,o.kt)("h3",{id:"domain-based-message-authentication-reporting--conformance--pass"},"Domain-based Message Authentication, Reporting & Conformance % Pass"),(0,o.kt)("p",null,"It's possible to configure your DMARC to subject less than 100% of your mail to filtering. This test makes sure you have your DMARC record configured to filter 100% of e-mails."),(0,o.kt)("h3",{id:"domain-name-system-security-extensions"},"Domain Name System Security Extensions"),(0,o.kt)("p",null,"A check that you have configured DNSSEC for the domain."),(0,o.kt)("p",null,"Domain Name System Security Extensions (DNSSEC) is a feature of DNS that authenticates responses to domain name look-ups, preventing attackers from manipulating or poisoning the responses to DNS requests."),(0,o.kt)("h3",{id:"domainkeys-identified-mail-enabled"},"DomainKeys Identified Mail Enabled"),(0,o.kt)("p",null,"A check that you have configured DKIM for the domain."),(0,o.kt)("p",null,"DKIM (DomainKeys Identified Mail) is an e-mail security standard designed to make sure messages aren't altered in transit between the sending and recipient servers. It uses public-key cryptography to sign e-mail with a private key as it leaves a sending server."),(0,o.kt)("h2",{id:"common-problems"},"Common Problems"),(0,o.kt)("p",null,"This feature requires that your Secure Application Model (SAM) app has the delegated permission ",(0,o.kt)("inlineCode",{parentName:"p"},"Domain.Read.All"),"."),(0,o.kt)("p",null,"You must give adequate time for the best practice Analyser to run. In an environment with 100 tenants this takes on average 2 minutes."),(0,o.kt)("p",null,"Check that your permissions are correct by navigating to ",(0,o.kt)("strong",{parentName:"p"},"CIPP Settings > Configuration Settings > Run Permission Check"),"."),(0,o.kt)("p",null,"Make sure both CIPP-API and CIPP are fully up-to-date. There is extensive logging in the log files in the CIPP-API Function App."),(0,o.kt)("h2",{id:"feature-requests--ideas"},"Feature Requests / Ideas"),(0,o.kt)("p",null,"Please raise any ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/KelvinTegelaar/CIPP/issues/new?assignees=&labels=&template=feature_request.md&title=FEATURE+REQUEST%3A+"},"feature requests")," on GitHub."),(0,o.kt)("h2",{id:"known-issues--limitations"},"Known Issues / Limitations"),(0,o.kt)(g,{mdxType:"NoKnownIssues"}))}h.isMDXComponent=!0}}]);